var square=document.getElementById("mode_cube");var circular=document.getElementById("mode_circular");var cut=document.getElementById("mode_cut");var hollow_1=document.getElementById("mode_hollow_1");var hollow_2=document.getElementById("mode_hollow_2");var hollow_3=document.getElementById("mode_hollow_3");var group_square=document.getElementById("menuGroup1");var group_circular=document.getElementById("menuGroup2");var group_cut=document.getElementById("menuGroup3");var group_hollow_1=document.getElementById("menuGroup4");var group_hollow_2=document.getElementById("menuGroup5");var group_hollow_3=document.getElementById("menuGroup6");function modeAllDown(){square.className="modeMenu-icon-down";circular.className="modeMenu-icon-down";cut.className="modeMenu-icon-down";hollow_1.className="modeMenu-icon-down";hollow_2.className="modeMenu-icon-down";hollow_3.className="modeMenu-icon-down"}
var switchDelayTime=300;square.addEventListener("click",function(){var group_light=document.getElementsByClassName("menuGroup")[0];if(group_square.className==="col-md-8 menuGroup2 position-absolute"){group_light.className="col-md-8 menuGroup2";modeAllDown();square.className="modeMenu-icon-up";setTimeout(function(){group_light.classList.add("position-absolute");group_square.className="col-md-8 menuGroup"},switchDelayTime)}});circular.addEventListener("click",function(){var group_light=document.getElementsByClassName("menuGroup")[0];if(group_circular.className==="col-md-8 menuGroup2 position-absolute"){group_light.className="col-md-8 menuGroup2";modeAllDown();circular.className="modeMenu-icon-up";setTimeout(function(){group_light.classList.add("position-absolute");group_circular.className="col-md-8 menuGroup"},switchDelayTime)}});cut.addEventListener("click",function(){var group_light=document.getElementsByClassName("menuGroup")[0];if(group_cut.className==="col-md-8 menuGroup2 position-absolute"){group_light.className="col-md-8 menuGroup2";modeAllDown();cut.className="modeMenu-icon-up";setTimeout(function(){group_light.classList.add("position-absolute");group_cut.className="col-md-8 menuGroup"},switchDelayTime)}});hollow_1.addEventListener("click",function(){var group_light=document.getElementsByClassName("menuGroup")[0];if(group_hollow_1.className==="col-md-8 menuGroup2 position-absolute"){group_light.className="col-md-8 menuGroup2";modeAllDown();hollow_1.className="modeMenu-icon-up";setTimeout(function(){group_light.classList.add("position-absolute");group_hollow_1.className="col-md-8 menuGroup"},switchDelayTime)}});hollow_2.addEventListener("click",function(){var group_light=document.getElementsByClassName("menuGroup")[0];if(group_hollow_2.className==="col-md-8 menuGroup2 position-absolute"){group_light.className="col-md-8 menuGroup2";modeAllDown();hollow_2.className="modeMenu-icon-up";setTimeout(function(){group_light.classList.add("position-absolute");group_hollow_2.className="col-md-8 menuGroup"},switchDelayTime)}});hollow_3.addEventListener("click",function(){var group_light=document.getElementsByClassName("menuGroup")[0];if(group_hollow_3.className==="col-md-8 menuGroup2 position-absolute"){group_light.className="col-md-8 menuGroup2";modeAllDown();hollow_3.className="modeMenu-icon-up";setTimeout(function(){group_light.classList.add("position-absolute");group_hollow_3.className="col-md-8 menuGroup"},switchDelayTime)}});var scene=new THREE.Scene();var scene2=new THREE.Scene();var camera=new THREE.PerspectiveCamera(45,window.innerWidth/500,1,10000);var webGLRenderer=new THREE.WebGLRenderer();var displayLoader=document.getElementById("loader");var status="complete";webGLRenderer.autoClear=!1;webGLRenderer.setClearColor(0xEEEEEE);webGLRenderer.setSize(window.innerWidth,500);camera.position.x=150;camera.position.y=50;camera.position.z=150;camera.lookAt(scene.position);var controls=new THREE.OrbitControls(camera,webGLRenderer.domElement);controls.enableDamping=!0;controls.dampingFactor=0.3;controls.enableZoom=!0;document.getElementById("container").appendChild(webGLRenderer.domElement);var axes=new THREE.AxisHelper(10);axes.rotation.x=-Math.PI/2;scene2.add(axes);window.addEventListener("mousemove",onMouseMove,!0);addShadowedLight(1,1,1,0xffffff,1);addShadowedLight(0.5,1,-1,0xffaa00,0.8);function addShadowedLight(x,y,z,color,intensity){var directionalLight=new THREE.DirectionalLight(color,intensity);directionalLight.position.set(x,y,z);scene.add(directionalLight);directionalLight.castShadow=!0;var d=1;directionalLight.shadow.camera.left=-d;directionalLight.shadow.camera.right=d;directionalLight.shadow.camera.top=d;directionalLight.shadow.camera.bottom=-d;directionalLight.shadow.camera.near=1;directionalLight.shadow.camera.far=4;directionalLight.shadow.mapSize.width=1024;directionalLight.shadow.mapSize.height=1024;directionalLight.shadow.bias=-0.002}
var gridSize=200;var gridDivisions=20;var gridHelper=new THREE.GridHelper(gridSize,gridDivisions);gridHelper.material.opacity=0.3;gridHelper.material.transparent=!0;scene2.add(gridHelper);var loader=new THREE.STLLoader();var mesh=[];var hidden=[];var ini=0;function readSTL(event){if(mergeSwitch){var files;var reader=new FileReader();if(event.target.files){files=event.target.files}
else{files=event.dataTransfer.files}
if(files[0]){reader.readAsDataURL(files[0])}
reader.onload=function(event){var fileName=files[0].name;var pointPosition=fileName.lastIndexOf(".");var fileType=fileName.substr(pointPosition+1);if(fileType=="stl"||fileType=="STL"){loader.load(reader.result,function(geometry){var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);hidden[ini]=mesh[ini].clone();ini=ini+1;num=num+1})}
else{alert("Only .stl data is accepted! Please try again!")}}}
else{alert("Already merged! Please EXPORT STL or RESTART!")}}
var mergeSwitch="on";function dropDown(mesh,peak){mesh.geometry.computeBoundingBox();if(mesh.geometry.name=="snake"){if(mesh.geometry.boundingBox.min.y>1&&mesh.geometry.boundingBox.min.y>peak+3&&mesh.geometry.boundingBox.min.y+10>peakHeight4snake+3){mesh.geometry.translate(0,-10,0);function drop(){dropDown(mesh,peak)}
setTimeout(drop,50)}
else if(mesh.geometry.boundingBox.min.y>1){mesh.geometry.translate(0,-10,0);mesh.translateY(10);function drop(){dropDown(mesh,peak)}
drop()}}
else{if(mesh.geometry.boundingBox.min.y>1&&mesh.geometry.boundingBox.min.y>peak+3){mesh.geometry.translate(0,-10,0);function drop(){dropDown(mesh,peak)}
setTimeout(drop,50)}
else if(mesh.geometry.boundingBox.min.y>1){mesh.geometry.translate(0,-10,0);mesh.translateY(10);function drop(){dropDown(mesh,peak)}
drop()}}}
Array.prototype.max=function(){var max=this[0];for(var i=1;i<this.length;i++){if(max<this[i]){max=this[i]}}
return max}
var allGeometry;var peakHeight=0;var peakHeight4snake=10;const objectHeight=80;function mergeToFindThePeak(){allGeometry=new THREE.Geometry();for(var i=2;i<scene.children.length;i++){if(scene.children[i].geometry.name!="3dPhoto"&&scene.children[i].geometry.name!="voxelModel"){if(scene.children[i].geometry.type=="BufferGeometry"){var geo=new THREE.Geometry().fromBufferGeometry(scene.children[i].geometry)}
else{var geo=scene.children[i].geometry}
scene.children[i].updateMatrix();allGeometry.merge(geo,scene.children[i].matrix)}}
allGeometry.mergeVertices();allGeometry.verticesNeedUpdate=!0}
function findThePeak(objectGeometry){mergeToFindThePeak();var coveredPoints=[],coveredPoints4snake=[];switch(objectGeometry.name){case "cube":for(var i=0;i<allGeometry.vertices.length;i++){if(-10<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<10&&-10<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
break;case "seven":for(var i=0;i<allGeometry.vertices.length;i++){if(0<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<30&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
break;case "tShape":for(var i=0;i<allGeometry.vertices.length;i++){if(0<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<30&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
break;case "stick":for(var i=0;i<allGeometry.vertices.length;i++){if(0<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<10&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
break;case "cover":for(var i=0;i<allGeometry.vertices.length;i++){if(0<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<10&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
break;case "single":for(var i=0;i<allGeometry.vertices.length;i++){if(0<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<10&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
break;case "snake":for(var i=0;i<allGeometry.vertices.length;i++){if(0<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<19&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints.push(allGeometry.vertices[i].y)}
if(20<allGeometry.vertices[i].x&&allGeometry.vertices[i].x<30&&0<allGeometry.vertices[i].z&&allGeometry.vertices[i].z<10){coveredPoints4snake.push(allGeometry.vertices[i].y)}}
if(coveredPoints.length>0){peakHeight=coveredPoints.max()}
if(coveredPoints4snake.length>0){peakHeight4snake=coveredPoints4snake.max()}
break}}
var cube=document.getElementById("cube");cube.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/4_4 cube.stl",function(geometry){num=num+1;Bnum=Bnum+8;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});geometry.name="cube";mesh[ini]=new THREE.Mesh(geometry,mat);mesh[ini].scale.set(1,1,1);geometry.center();findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var seven=document.getElementById("seven");seven.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/seven.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="seven";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var snake=document.getElementById("snake");snake.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/snake_1.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="snake";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var stick=document.getElementById("stick");stick.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/stick.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="stick";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var tShape=document.getElementById("T");tShape.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/T.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="tShape";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cover=document.getElementById("top");cover.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/top.stl",function(geometry){num=num+1;Bnum=Bnum+1.5;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cover";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var single=document.getElementById("single");single.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/single/cube.stl",function(geometry){num=num+1;Bnum=Bnum+1;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="single";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cube2=document.getElementById("cube2");cube2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/2ver/4_4_cube_2ver.stl",function(geometry){num=num+1;Bnum=Bnum+8;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cube";mesh[ini].scale.set(1,1,1);geometry.center();findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var tShape2=document.getElementById("T2");tShape2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/2ver/T_2ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="tShape";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var seven2=document.getElementById("seven2");seven2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/2ver/seven_2ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="seven";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var snake2=document.getElementById("snake2");snake2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/2ver/snake_2ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="snake";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var stick2=document.getElementById("stick2");stick2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/2ver/stick_2ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="stick";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cover2=document.getElementById("top2");cover2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/2ver/top_2ver.stl",function(geometry){num=num+1;Bnum=Bnum+1.5;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cover";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var single2=document.getElementById("single2");single2.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/hide/single_hide.stl",function(geometry){var mat=new THREE.MeshStandardMaterial({color:0x0000ff,transparent:!0,side:THREE.DoubleSide,opacity:0});hidden[ini]=new THREE.Mesh(geometry,mat);hidden[ini].scale.set(1,1,1);hidden[ini].position.y=-10;geometry.name="hidden"});loader.load("stl/single/circular.stl",function(geometry){num=num+1;Bnum=Bnum+1;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="single";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);mesh[ini].add(hidden[ini]);dropDown(mesh[ini],peakHeight);hidden[ini].geometry.translate(0,peakHeight,0);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cube3=document.getElementById("cube3");cube3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/3ver/4_4_cube_3ver.stl",function(geometry){num=num+1;Bnum=Bnum+8;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cube";mesh[ini].scale.set(1,1,1);geometry.center();findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var tShape3=document.getElementById("T3");tShape3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/3ver/T_3ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="tShape";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var seven3=document.getElementById("seven3");seven3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/3ver/seven_3ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="seven";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var snake3=document.getElementById("snake3");snake3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/3ver/snake_3ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="snake";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var stick3=document.getElementById("stick3");stick3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/3ver/stick_3ver.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="stick";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cover3=document.getElementById("top3");cover3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/3ver/top_3ver.stl",function(geometry){num=num+1;Bnum=Bnum+1.5;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cover";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var single3=document.getElementById("single3");single3.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/hide/single_hide.stl",function(geometry){var mat=new THREE.MeshStandardMaterial({color:0x0000ff,transparent:!0,side:THREE.DoubleSide,opacity:0});hidden[ini]=new THREE.Mesh(geometry,mat);hidden[ini].scale.set(1,1,1);hidden[ini].position.y=-10;geometry.name="hidden"});loader.load("stl/single/cut.stl",function(geometry){num=num+1;Bnum=Bnum+1;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="single";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);mesh[ini].add(hidden[ini]);dropDown(mesh[ini],peakHeight);hidden[ini].geometry.translate(0,peakHeight,0);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var advanceSwitch="on";var cube4=document.getElementById("cube4");cube4.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_1/4_4_cube_hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+8;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cube";mesh[ini].scale.set(1,1,1);geometry.center();findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var tShape4=document.getElementById("T4");tShape4.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_1/T_hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="tShape";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var seven4=document.getElementById("seven4");seven4.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_1/seven_hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="seven";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var snake4=document.getElementById("snake4");snake4.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_1/snake_hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="snake";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var stick4=document.getElementById("stick4");stick4.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_1/stick_hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="stick";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cover4=document.getElementById("top4");cover4.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_1/top_hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+1.5;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cover";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var single4=document.getElementById("single4");single4.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/single/hollow_1.stl",function(geometry){num=num+1;Bnum=Bnum+1;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="single";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);mesh[ini].add(hidden[ini]);dropDown(mesh[ini],peakHeight);hidden[ini].geometry.translate(0,peakHeight,0);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cube5=document.getElementById("cube5");cube5.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_2/4_4_cube_hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+8;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cube";mesh[ini].scale.set(1,1,1);geometry.center();findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var tShape5=document.getElementById("T5");tShape5.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_2/T_hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="tShape";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var seven5=document.getElementById("seven5");seven5.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_2/seven_hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="seven";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var snake5=document.getElementById("snake5");snake5.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_2/snake_hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="snake";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var stick5=document.getElementById("stick5");stick5.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_2/stick_hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="stick";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cover5=document.getElementById("top5");cover5.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_2/top_hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+1.5;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cover";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var single5=document.getElementById("single5");single5.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/single/hollow_2.stl",function(geometry){num=num+1;Bnum=Bnum+1;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="single";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);mesh[ini].add(hidden[ini]);dropDown(mesh[ini],peakHeight);hidden[ini].geometry.translate(0,peakHeight,0);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cube6=document.getElementById("cube6");cube6.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_3/4_4_cube_hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+8;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cube";mesh[ini].scale.set(1,1,1);geometry.center();findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var tShape6=document.getElementById("T6");tShape6.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_3/T_hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="tShape";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var seven6=document.getElementById("seven6");seven6.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_3/seven_hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="seven";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var snake6=document.getElementById("snake6");snake6.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_3/snake_hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="snake";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var stick6=document.getElementById("stick6");stick6.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_3/stick_hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+4;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="stick";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var cover6=document.getElementById("top6");cover6.addEventListener("click",function(){if(mergeSwitch){advanceSwitch="off";loader.load("stl/hollow_3/top_hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+1.5;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cover";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);dropDown(mesh[ini],peakHeight);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var single6=document.getElementById("single6");single6.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/single/hollow_3.stl",function(geometry){num=num+1;Bnum=Bnum+1;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="single";mesh[ini].scale.set(1,1,1);findThePeak(geometry);geometry.translate(0,peakHeight+objectHeight,0);scene.add(mesh[ini]);mesh[ini].add(hidden[ini]);dropDown(mesh[ini],peakHeight);hidden[ini].geometry.translate(0,peakHeight,0);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});var sample_cup=document.getElementById("sample_cup");var sample_headphoneStand=document.getElementById("sample_headphone-stand");var sample_penHolder=document.getElementById("sample_pen-holder");var sample_plantPot=document.getElementById("sample_plant");var sample_iphoneStand=document.getElementById("sample_iphone-stand");sample_cup.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/default models/sample_cup.stl",function(geometry){num=num+1;Bnum=Bnum+344;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="cup";mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});sample_headphoneStand.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/default models/headphone stand_lower.stl",function(geometry){num=num+1;Bnum=Bnum+58;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="headphoneStand_lower";mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);ini=ini+1;loader.load("stl/default models/headphone stand_upper.stl",function(geometry){num=num+1;Bnum=Bnum+60;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="headphoneStand_upper";mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);ini=ini+1})})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});sample_penHolder.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/default models/sample_pen_holder.stl",function(geometry){num=num+1;Bnum=Bnum+344;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="penHolder";mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});sample_plantPot.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/default models/sample_plant.stl",function(geometry){num=num+1;Bnum=Bnum+166;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="plantPot";mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});sample_iphoneStand.addEventListener("click",function(){if(mergeSwitch){loader.load("stl/default models/sample_iphone_stand.stl",function(geometry){num=num+1;Bnum=Bnum+64;var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.name="iphoneStand";mesh[ini].scale.set(1,1,1);scene.add(mesh[ini]);ini=ini+1})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}});function remap(x,inMin,inMax,outMin,outMax){var xPosition=Math.abs(x-inMin);var output=outMin+xPosition*(outMax-outMin)/Math.abs(inMax-inMin);return output}
var photo3dBtn=document.getElementById("picture_mode");photo3dBtn.addEventListener("click",function(){if(mergeSwitch){photo3dBtn.dataset.target="#photoBackColorModal";document.getElementById("3dImageStage1").dataset.target="#photoSizeModal";document.getElementById("3dImageStage2").dataset.target="#photoThicknessModal";document.getElementById("3dImageStage3").dataset.target="#voxelResolutionModal"}
else{photo3dBtn.dataset.target="";alert("Already merged! Please EXPORT STL or RESTART!")}});var tempStorage,tempStorage_2;document.getElementById("body").addEventListener("click",function(){backgroundColor=null;photoSize=null;photoThickness=null});var backgroundColor,backgroundSplit,photoSizeH,photoSizeW,photoThickness,photoResolution,photoSeperate,puzzle;backgroundSplit="no";document.getElementById("whiteBack").addEventListener("click",function(){setTimeout(function(){backgroundColor="white"},100)});document.getElementById("blackBack").addEventListener("click",function(){setTimeout(function(){backgroundColor="black"},100)});document.getElementById("mixedBack").addEventListener("click",function(){setTimeout(function(){backgroundColor="mixed"},100)});var natural_circle=document.getElementById("natural");var seperate_circle=document.getElementById("seperateBack");natural_circle.addEventListener("click",function(){backgroundSplit="no";natural_circle.className="sub-selection-item sub-selection-circle-pressed";seperate_circle.className="sub-selection-item sub-selection-circle-released"});seperate_circle.addEventListener("click",function(){backgroundSplit="yes";natural_circle.className="sub-selection-item sub-selection-circle-released";seperate_circle.className="sub-selection-item sub-selection-circle-pressed"});document.getElementById("photoBackColorModal").addEventListener("click",function(){if(backgroundColor){tempStorage=backgroundColor;backgroundColor=null}});var sizeC_H=document.getElementById("customSizeH");var sizeC_W=document.getElementById("customSizeW");document.getElementById("photoBigSize").addEventListener("click",function(){setTimeout(function(){photoSizeH=15;photoSizeW=15;sizeC_H.value=null;sizeC_W.value=null},100)});document.getElementById("photoMediumSize").addEventListener("click",function(){setTimeout(function(){photoSizeH=10;photoSizeW=10;sizeC_H.value=null;sizeC_W.value=null},100)});document.getElementById("photoSmallSize").addEventListener("click",function(){setTimeout(function(){photoSizeH=5;photoSizeW=5;sizeC_H.value=null;sizeC_W.value=null},100)});sizeC_H.addEventListener("click",function(){setTimeout(function(){photoSizeH=null;photoSizeW=null},100)});sizeC_W.addEventListener("click",function(){setTimeout(function(){photoSizeH=null;photoSizeW=null},100)});document.getElementById("photoSizeModal").addEventListener("click",function(){if(photoSizeH&&photoSizeW){tempStorage=photoSizeH;tempStorage_2=photoSizeW;photoSizeH=null;photoSizeW=null}});var thicknessC=document.getElementById("customThickness");document.getElementById("photoBigThickness").addEventListener("click",function(){setTimeout(function(){photoThickness=20;thicknessC.value=null},100)});document.getElementById("photoMediumThickness").addEventListener("click",function(){setTimeout(function(){photoThickness=10;thicknessC.value=null},100)});document.getElementById("photoSmallThickness").addEventListener("click",function(){setTimeout(function(){photoThickness=5;thicknessC.value=null},100)});thicknessC.addEventListener("click",function(){setTimeout(function(){photoThickness=null},100)});document.getElementById("photoThicknessModal").addEventListener("click",function(){if(photoThickness){tempStorage=photoThickness;photoThickness=null}});var resoBig=document.getElementById("voxelResolutionBig");var resoMid=document.getElementById("voxelResolutionMedium");var resoSml=document.getElementById("voxelResolutionSmall");photoSeperate="no"
var sepNo=document.getElementById("voxelSeperateNo");var sepYes=document.getElementById("voxelSeperateYes");puzzle="no";var puzzle_selection=document.getElementById("puzzle-sub");var noGap_circle=document.getElementById("noGap");var yesGap_circle=document.getElementById("yesGap");resoBig.addEventListener("click",function(){resoBig.className="importBtn accuracy-degree-pressed accuracy-position1";resoMid.className="importBtn accuracy-degree accuracy-position2";resoSml.className="importBtn accuracy-degree accuracy-position3";setTimeout(function(){photoResolution=120},100)});resoMid.addEventListener("click",function(){resoBig.className="importBtn accuracy-degree accuracy-position1";resoMid.className="importBtn accuracy-degree-pressed accuracy-position2";resoSml.className="importBtn accuracy-degree accuracy-position3";setTimeout(function(){photoResolution=80},100)});resoSml.addEventListener("click",function(){resoBig.className="importBtn accuracy-degree accuracy-position1";resoMid.className="importBtn accuracy-degree accuracy-position2";resoSml.className="importBtn accuracy-degree-pressed accuracy-position3";setTimeout(function(){photoResolution=50},100)});sepNo.addEventListener("click",function(){sepNo.className="importBtn accuracy-degree-pressed accuracy-position1";sepYes.className="importBtn accuracy-degree accuracy-position3";photoSeperate="no";puzzle_selection.className="sub-selection sub-selection-hide";puzzle="no";noGap_circle.className="sub-selection-item sub-selection-circle-pressed";yesGap_circle.className="sub-selection-item sub-selection-circle-released"});sepYes.addEventListener("click",function(){sepNo.className="importBtn accuracy-degree accuracy-position1";sepYes.className="importBtn accuracy-degree-pressed accuracy-position3";photoSeperate="yes";puzzle_selection.className="sub-selection"});noGap_circle.addEventListener("click",function(){puzzle="no";noGap_circle.className="sub-selection-item sub-selection-circle-pressed";yesGap_circle.className="sub-selection-item sub-selection-circle-released"});yesGap_circle.addEventListener("click",function(){puzzle="yes";noGap_circle.className="sub-selection-item sub-selection-circle-released";yesGap_circle.className="sub-selection-item sub-selection-circle-pressed"});var originalTarget;function checkAnswer(object){var btnSelection;var alertContent;var alertLock="open";var reg=/^([1-9][0-9]*){1,3}$/;switch(object.dataset.stage){case "first":btnSelection=backgroundColor;alertContent="background color"
if(backgroundColor){setTimeout(function(){backgroundColor=tempStorage;realColor=backgroundColor},30)}
break;case "second":if(sizeC_H.value&&sizeC_W.value){if(reg.test(sizeC_H.value)){photoSizeH=parseInt(sizeC_H.value)}
else{alert("Custonmized value only accepts integers!");alertLock=null;return}
if(reg.test(sizeC_W.value)){photoSizeW=parseInt(sizeC_W.value)}
else{alert("Custonmized value only accepts integers!");alertLock=null;return}}
btnSelection=photoSizeH;alertContent="size"
if(photoSizeH&&photoSizeW){setTimeout(function(){photoSizeH=tempStorage;photoSizeW=tempStorage_2;realSizeH=photoSizeH;realSizeW=photoSizeW},30)}
break;case "third":if(thicknessC.value){if(reg.test(thicknessC.value)){photoThickness=parseInt(thicknessC.value)}
else{alert("Custonmized value only accepts integers!");alertLock=null;return}}
btnSelection=photoThickness;alertContent="thickness"
if(photoThickness){setTimeout(function(){photoThickness=tempStorage;realThickness=photoThickness;photoResolution=80},30)}
break;case "fourth":btnSelection=photoResolution;alertContent="resolution"
if(photoResolution){realResolution=photoResolution}
var inputBtn=document.getElementById("imgFile");if(btnSelection){inputBtn.type="file"}
else{inputBtn.type=""}
break}
if(object.dataset.target){originalTarget=object.dataset.target}
if(btnSelection==null){if(alertLock){alert("please choose the "+alertContent+" value of your photo before continue!")}
object.dataset.target='';object.dataset.dismiss=''}
if(btnSelection){if(object.dataset.stage!="fourth"){object.dataset.target=originalTarget;object.dataset.dismiss='modal'}}}
function cancel(event){backgroundColor=null;photoSize=null;photoThickness=null;photoResolution=null}
var realColor,realSizeH,realSizeW,realThickness,realResolution;function readImgForVoxel(event){document.getElementById("importModalCancel").click();var files;var reader=new FileReader();if(event.target.files){files=event.target.files}
else{files=event.dataTransfer.files}
if(files[0]){reader.readAsDataURL(files[0])}
reader.onload=function(event){var fileName=files[0].name;var pointPosition=fileName.lastIndexOf(".");var fileType=fileName.substr(pointPosition+1);if(fileType=="jpg"||fileType=="png"){if(realColor&&realSizeH&&realSizeW&&realThickness&&realResolution){status="running";setTimeout(function(){var img3D=new voxelIMG();img3D.set(realColor,realSizeH,realSizeW,realThickness,realResolution,backgroundSplit,photoSeperate,puzzle,mycontext,Number(mycanvas.height),Number(mycanvas.width));mycanvas.classList.remove("sr-only");img3D.voxelize(reader.result,function(geometry,pieceAmount){for(var i=0;i<geometry.length;i++){var material=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry[i],material);scene.add(mesh[ini]);ini=ini+1}
num=num+pieceAmount;status="complete"})},300);sizeC_H.value="";sizeC_W.value="";thicknessC.value=""}
else{alert("Something goes wrong! please try again!")}}
else{alert("Only IMAGE data(Ex: .jpeg or .png file) is accepted! Please try again!")}}}
var mycanvas=document.getElementById("myCanvas");var mycontext=mycanvas.getContext('2d');var cubeType,solidOrHollow;document.getElementById("voxel_mode_cube").addEventListener("click",function(){cubeType="stl/single/cube.stl";solidOrHollow="solid"});document.getElementById("voxel_mode_circular").addEventListener("click",function(){cubeType="stl/single/circular.stl";solidOrHollow="solid"});document.getElementById("voxel_mode_cut").addEventListener("click",function(){cubeType="stl/single/cut.stl";solidOrHollow="solid"});document.getElementById("voxel_mode_hollow_1").addEventListener("click",function(){cubeType="stl/single/hollow_1.stl";solidOrHollow="hollow"});document.getElementById("voxel_mode_hollow_2").addEventListener("click",function(){cubeType="stl/single/hollow_2.stl";solidOrHollow="hollow"});document.getElementById("voxel_mode_hollow_3").addEventListener("click",function(){cubeType="stl/single/hollow_3.stl";solidOrHollow="hollow"});var cubeSize=0.3;var voxelResBig=document.getElementById("10AccuracyBtn");var voxelResMid=document.getElementById("1AccuracyBtn");var voxelResSml=document.getElementById("halfAccuracyBtn");voxelResBig.addEventListener("click",function(){voxelResBig.className="importBtn accuracy-degree-pressed accuracy-position1";voxelResMid.className="importBtn accuracy-degree accuracy-position2";voxelResSml.className="importBtn accuracy-degree accuracy-position3";cubeSize=0.2});voxelResMid.addEventListener("click",function(){voxelResBig.className="importBtn accuracy-degree accuracy-position1";voxelResMid.className="importBtn accuracy-degree-pressed accuracy-position2";voxelResSml.className="importBtn accuracy-degree accuracy-position3";cubeSize=0.3});voxelResSml.addEventListener("click",function(){voxelResBig.className="importBtn accuracy-degree accuracy-position1";voxelResMid.className="importBtn accuracy-degree accuracy-position2";voxelResSml.className="importBtn accuracy-degree-pressed accuracy-position3";cubeSize=0.5});var objectX,objectY,objectZ;function readSTLforVoxel(event){document.getElementById("closeModalAfterImport").click();var files;var reader=new FileReader();if(event.target.files){files=event.target.files}
else{files=event.dataTransfer.files}
if(files[0]){reader.readAsDataURL(files[0])}
reader.onload=function(event){var fileName=files[0].name;var pointPosition=fileName.lastIndexOf(".");var fileType=fileName.substr(pointPosition+1);if(fileType=="stl"||fileType=="STL"){if(cubeType&&cubeSize){voxelizeSTL(reader.result)}
else{alert("Something goes wrong! please try again!")}}
else{alert("Only .stl data is accepted! Please try again!")}}}
var favAllData=[];var favLineData=[];var favLayerData=[];var dataToExport='';var voxelAmountX,voxelAmountY,voxelAmountZ;function voxelizeSTL(url){status="running";setTimeout(function(){var stage1=[],stage2=[],stage3=[],stage4=[],stage5=[];var mixedGeometry=new THREE.Geometry();var realGeo;if(mergeSwitch){loader.load(url,function(geometry){var originalMesh=new THREE.Mesh(geometry);originalMesh.scale.set(1,1,1);originalMesh.geometry.center();meshSize(originalMesh);originalMesh.geometry.translate(0,yFactor/2,0);realGeo=new THREE.Geometry().fromBufferGeometry(geometry);objectX=xFactor;objectY=yFactor;objectZ=zFactor;for(var i=0;i<realGeo.vertices.length;i++){if((objectY/5)*1>realGeo.vertices[i].y&&realGeo.vertices[i].y>0){stage1.push(realGeo.vertices[i].clone())}
if((objectY/5)*2>realGeo.vertices[i].y&&realGeo.vertices[i].y>=objectY/5){stage2.push(realGeo.vertices[i].clone())}
if((objectY/5)*1>realGeo.vertices[i].y&&realGeo.vertices[i].y>=(objectY/5)*1-10*cubeSize){stage2.push(realGeo.vertices[i].clone())}
if((objectY/5)*3>realGeo.vertices[i].y&&realGeo.vertices[i].y>=(objectY/5)*2){stage3.push(realGeo.vertices[i].clone())}
if((objectY/5)*2>realGeo.vertices[i].y&&realGeo.vertices[i].y>=(objectY/5)*2-10*cubeSize){stage3.push(realGeo.vertices[i].clone())}
if((objectY/5)*4>realGeo.vertices[i].y&&realGeo.vertices[i].y>=(objectY/5)*3){stage4.push(realGeo.vertices[i].clone())}
if((objectY/5)*3>realGeo.vertices[i].y&&realGeo.vertices[i].y>=(objectY/5)*3-10*cubeSize){stage4.push(realGeo.vertices[i].clone())}
if(realGeo.vertices[i].y>=(objectY/5)*4){stage5.push(realGeo.vertices[i].clone())}
if((objectY/5)*4>realGeo.vertices[i].y&&realGeo.vertices[i].y>=(objectY/5)*4-10*cubeSize){stage5.push(realGeo.vertices[i].clone())}}
var centerPoint=new THREE.Geometry();var pointAmountOfEachFace=3;var centerX,centerY,centerZ,temp;for(var i=0;i<realGeo.faces.length;i++){var pointXFactors=[realGeo.vertices[realGeo.faces[i].a].x,realGeo.vertices[realGeo.faces[i].b].x,realGeo.vertices[realGeo.faces[i].c].x];var pointYFactors=[realGeo.vertices[realGeo.faces[i].a].y,realGeo.vertices[realGeo.faces[i].b].y,realGeo.vertices[realGeo.faces[i].c].y];var pointZFactors=[realGeo.vertices[realGeo.faces[i].a].z,realGeo.vertices[realGeo.faces[i].b].z,realGeo.vertices[realGeo.faces[i].c].z];centerX=(pointXFactors[0]+pointXFactors[1]+pointXFactors[2])/3;centerY=(pointYFactors[0]+pointYFactors[1]+pointYFactors[2])/3;centerZ=(pointZFactors[0]+pointZFactors[1]+pointZFactors[2])/3;centerPoint.vertices.push(new THREE.Vector3(centerX,centerY,centerZ));centerPoint.vertices.push(new THREE.Vector3((centerX+pointXFactors[0])/2,(centerY+pointYFactors[0])/2,(centerZ+pointZFactors[0])/2));centerPoint.vertices.push(new THREE.Vector3((centerX+pointXFactors[1])/2,(centerY+pointYFactors[1])/2,(centerZ+pointZFactors[1])/2));centerPoint.vertices.push(new THREE.Vector3((centerX+pointXFactors[2])/2,(centerY+pointYFactors[3])/2,(centerZ+pointZFactors[2])/2))}
for(var i=0;i<centerPoint.vertices.length;i++){if((objectY/5)*1>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>0){stage1.push(centerPoint.vertices[i].clone())}
if((objectY/5)*1>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*1-10*cubeSize){stage2.push(centerPoint.vertices[i].clone())}
if((objectY/5)*2>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*1){stage2.push(centerPoint.vertices[i].clone())}
if((objectY/5)*2>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*2-10*cubeSize){stage3.push(centerPoint.vertices[i].clone())}
if((objectY/5)*3>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*2){stage3.push(centerPoint.vertices[i].clone())}
if((objectY/5)*3>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*3-10*cubeSize){stage4.push(centerPoint.vertices[i].clone())}
if((objectY/5)*4>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*3){stage4.push(centerPoint.vertices[i].clone())}
if((objectY/5)*4>centerPoint.vertices[i].y&&centerPoint.vertices[i].y>=(objectY/5)*4-10*cubeSize){stage5.push(centerPoint.vertices[i].clone())}
if(centerPoint.vertices[i].y>=(objectY/5)*4){stage5.push(centerPoint.vertices[i].clone())}}
console.log(stage1.length+" "+stage2.length+" "+stage3.length+" "+stage4.length+" "+stage5.length)});loader.load(cubeType,function(geometry){var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});geometry.scale(cubeSize,cubeSize,cubeSize);var geo=new THREE.Geometry().fromBufferGeometry(geometry);geo.center();meshSize(geo);var halfX=objectX/2;var halfY=objectZ/2;geo.translate(-halfX,yFactor/2,-halfY);var xAmount=Math.ceil(objectX/xFactor)+1;var yAmount=Math.ceil(objectZ/zFactor)+1;var zAmount=Math.ceil(objectY/yFactor)+1;voxelAmountX=xAmount;voxelAmountY=yAmount;voxelAmountZ=zAmount;var total=xAmount*yAmount*zAmount;var blocksSTL=[];for(var i=0;i<total;i++){blocksSTL[i]=geo.clone();var moveX=i%xAmount;var moveY=parseInt(i/xAmount)%yAmount;var moveZ=parseInt(i/(xAmount*yAmount));blocksSTL[i].translate(moveX*xFactor,moveZ*yFactor,moveY*zFactor);blocksSTL[i].computeBoundingBox();var maxX=blocksSTL[i].boundingBox.max.x;var maxY=blocksSTL[i].boundingBox.max.y;var maxZ=blocksSTL[i].boundingBox.max.z;var minX=blocksSTL[i].boundingBox.min.x;var minY=blocksSTL[i].boundingBox.min.y;var minZ=blocksSTL[i].boundingBox.min.z;if(0<=maxY&&maxY<(objectY/5)*1){var collision="no";for(var j=0;j<stage1.length;j++){if(stage1[j].x>maxX||stage1[j].x<minX||stage1[j].y>maxY||stage1[j].y<minY||stage1[j].z>maxZ||stage1[j].z<minZ){collision="no";continue}
else{favAllData.push("1");collision="yes";mixedGeometry.merge(blocksSTL[i]);break}}
if(collision=="no"){favAllData.push("0")}}
if((objectY/5)*1<=maxY&&maxY<(objectY/5)*2){var collision="no";for(var j=0;j<stage2.length;j++){if(stage2[j].x>maxX||stage2[j].x<minX||stage2[j].y>maxY||stage2[j].y<minY||stage2[j].z>maxZ||stage2[j].z<minZ){collision="no";continue}
else{favAllData.push("1");collision="yes";mixedGeometry.merge(blocksSTL[i]);break}}
if(collision=="no"){favAllData.push("0")}}
if(objectY*(2/5)<=maxY&&maxY<objectY*(3/5)){var collision="no";for(var j=0;j<stage3.length;j++){if(stage3[j].x>maxX||stage3[j].x<minX||stage3[j].y>maxY||stage3[j].y<minY||stage3[j].z>maxZ||stage3[j].z<minZ){collision="no";continue}
else{favAllData.push("1");collision="yes";mixedGeometry.merge(blocksSTL[i]);break}}
if(collision=="no"){favAllData.push("0")}}
if(objectY*(3/5)<=maxY&&maxY<objectY*(4/5)){var collision="no";for(var j=0;j<stage4.length;j++){if(stage4[j].x>maxX||stage4[j].x<minX||stage4[j].y>maxY||stage4[j].y<minY||stage4[j].z>maxZ||stage4[j].z<minZ){collision="no";continue}
else{favAllData.push("1");collision="yes";mixedGeometry.merge(blocksSTL[i]);break}}
if(collision=="no"){favAllData.push("0")}}
if(objectY*(4/5)<=maxY){var collision="no";for(var j=0;j<stage5.length;j++){if(stage5[j].x>maxX||stage5[j].x<minX||stage5[j].y>maxY||stage5[j].y<minY||stage5[j].z>maxZ||stage5[j].z<minZ){collision="no";continue}
else{favAllData.push("1");collision="yes";mixedGeometry.merge(blocksSTL[i]);break}}
if(collision=="no"){favAllData.push("0")}}}
var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mixedGeometry.mergeVertices();mixedGeometry.verticesNeedUpdate=!0;mixedGeometry.name="voxelModel";mesh[ini]=new THREE.Mesh(mixedGeometry,mat);scene.add(mesh[ini]);ini=ini+1;num=num+1;status="complete"})}
else{alert("Already merged! Please EXPORT STL or RESTART!")}},100)}
var textContent,fontName,fontURL,texSize,textThickness;var currentFont=document.getElementById("currentFont");document.getElementById("font1").addEventListener("click",function(){fontURL="json_fonts/Arial Rounded MT Bold_Regular.json";fontName="Arial";currentFont.innerHTML="Current font: "+fontName});document.getElementById("font2").addEventListener("click",function(){fontURL="json_fonts/Bodoni MT_Bold.json";fontName="Bodoni";currentFont.innerHTML="Current font: "+fontName});document.getElementById("font3").addEventListener("click",function(){fontURL="json_fonts/gentilis_bold.typeface.json";fontName="Gentilis";currentFont.innerHTML="Current font: "+fontName});document.getElementById("font4").addEventListener("click",function(){fontURL="json_fonts/helvetiker_bold.typeface.json";fontName="Helvetiker";currentFont.innerHTML="Current font: "+fontName});document.getElementById("font5").addEventListener("click",function(){fontURL="json_fonts/optimer_bold.typeface.json";fontName="Optimer";currentFont.innerHTML="Current font: "+fontName});var generateText=document.getElementById("generateText");var cancelText=document.getElementById("textModalCancel");var contentInput=document.getElementById("textContent");var sizeInput=document.getElementById("textSize");var thicknessInput=document.getElementById("textHeight");generateText.addEventListener("click",function(){var reg=/^([1-9][0-9]*){1,3}$/;if(contentInput.value){textContent=contentInput.value}
if(sizeInput.value){if(reg.test(sizeInput.value)){textSize=parseInt(sizeInput.value)}
else{alert("The Size and Distance blank only accept integers!");return}}
if(thicknessInput.value){if(reg.test(thicknessInput.value)){textThickness=parseInt(thicknessInput.value)}
else{alert("The Size and Distance blank only accept integers!");return}}
if(fontURL&&textContent&&textSize&&textThickness){text3D(textContent,fontURL,textSize,textThickness);cancelText.click()}
else{alert("Is every parameter blank filled properly? Please check again!")}});function removeTextParameter(event){setTimeout(function(){contentInput.value="";sizeInput.value="";thicknessInput.value="";textContent=null;textSize=null;textThickness=null;fontURL=null;fontName="None";currentFont.innerHTML="Current font: "+fontName},100)}
function text3D(content,fontType,size,thickness){var loader=new THREE.FontLoader();loader.load(fontType,function(font){var geometry=new THREE.TextGeometry(content,{font:font,size:size,height:thickness,curveSegments:12,});var mat=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});mesh[ini]=new THREE.Mesh(geometry,mat);geometry.center();geometry.rotateX(-Math.PI/2);geometry.translate(0,thickness/2,0);geometry.name="text";scene.add(mesh[ini]);ini=ini+1;num=num+1})}
var xFactor,yFactor,zFactor;function meshSize(object){if(object.type=="Geometry"||object.type=="BufferGeometry"){object.computeBoundingBox();xFactor=object.boundingBox.max.x-object.boundingBox.min.x;yFactor=object.boundingBox.max.y-object.boundingBox.min.y;zFactor=object.boundingBox.max.z-object.boundingBox.min.z}
else{object.geometry.computeBoundingBox();xFactor=object.geometry.boundingBox.max.x-object.geometry.boundingBox.min.x;yFactor=object.geometry.boundingBox.max.y-object.geometry.boundingBox.min.y;zFactor=object.geometry.boundingBox.max.z-object.geometry.boundingBox.min.z}}
var mold,moldCube,mold_bsp,prey_bsp,subtract_bsp,moldResult;mold=document.getElementById("mold_mode");mold.addEventListener("click",function(){if(mergedMesh&&advanceSwitch=="on"){status="running";setTimeout(function(){meshSize(mergedMesh);scene.remove(mergedMesh);mergedMesh.geometry.center();var material=new THREE.MeshStandardMaterial({color:0x83d46a,side:THREE.DoubleSide});var mergedMeshCentered=new THREE.Mesh(mergedMesh.geometry,material);mergedMeshCentered.translateY(yFactor/2-1);prey_bsp=new ThreeBSP(mergedMeshCentered);var moldBox=new THREE.BoxGeometry(xFactor+10,yFactor+5,zFactor+10);var moldMaterial=new THREE.MeshStandardMaterial({color:0x4ab3df,side:THREE.DoubleSide});var boxMesh=new THREE.Mesh(moldBox,moldMaterial);meshSize(boxMesh);boxMesh.translateY(yFactor/2);mold_bsp=new ThreeBSP(boxMesh);subtract_bsp=mold_bsp.subtract(prey_bsp);moldResult=subtract_bsp.toMesh(new THREE.MeshStandardMaterial({color:0x4ab3df,side:THREE.DoubleSide}));moldResult.rotateX(Math.PI);scene.add(moldResult);mergedMesh.geometry.dispose();mergedMesh.material.dispose();mergedMesh=undefined;status="complete";alert("Successfully molded")},100)}
else if(mergedMesh==null){alert("Objects haven't been merged / Merged object has already been through advanced functions")}
else if(advanceSwitch=="off"){alert("This function only supports solid modes")}});var emptyMat,emptyMat_mesh;function hollow(object){var movedMesh=[];var thickness=2.5;var intersect;var intersect_bsp=new ThreeBSP(object);var objectMoved=object;var objectMoved2=object;function intersection(i){movedMesh[i]=new ThreeBSP(objectMoved);intersect_bsp=intersect_bsp.intersect(movedMesh[i]);objectMoved=intersect_bsp.toMesh()}
objectMoved.position.x=thickness;objectMoved.position.y=-thickness;objectMoved.position.z=thickness;intersection(0);objectMoved2.position.x=-thickness;objectMoved2.position.z=-thickness;movedMesh[1]=new ThreeBSP(objectMoved2);intersect_bsp=intersect_bsp.intersect(movedMesh[1]);objectMoved.position.x=-thickness;objectMoved.position.z=-thickness;intersection(2);emptyMat_mesh=intersect_bsp.toMesh()}
var lampResult;var hollowBtn=document.getElementById("hollow_mode");hollowBtn.addEventListener("click",function(){alert("This function has not been ready!")});var clearPre=document.getElementById("clearPrevious");clearPre.addEventListener("click",function(){if(ini>0&&mergeSwitch&&scene.children.length>2){if(num>0){num=num-1}
if(Bnum>0){switch(scene.children[scene.children.length-1].geometry.name){case "cube":Bnum=Bnum-8;break;case "seven":Bnum=Bnum-4;break;case "tShape":Bnum=Bnum-4;break;case "snake":Bnum=Bnum-4;break;case "stick":Bnum=Bnum-4;break;case "cover":Bnum=Bnum-1.5;break;case "cup":Bnum=Bnum-344;break;case "headphoneStand_lower":Bnum=Bnum-58;break;case "headphoneStand_upper":Bnum=Bnum-60;break;case "penHolder":Bnum=Bnum-344;break;case "plantPot":Bnum=Bnum-166;break;case "iphoneStand":Bnum=Bnum-64;break}}
scene.children[scene.children.length-1].geometry.dispose();scene.children[scene.children.length-1].material.dispose();scene.remove(scene.children[scene.children.length-1]);ini=ini-1;var still3dPhoto=null;for(var i=2;i<scene.children.length;i++){if(scene.children[i].geometry.name=="3dPhoto"){still3dPhoto="yes";break}}
if(still3dPhoto!="yes"){if(mycanvas.className=="topMenuIcon imgCanvas"){mycanvas.classList.add("sr-only");mycontext.clearRect(0,0,60,60)}}}
else if(mergeSwitch==null){alert("Already merged! Please EXPORT or RESTART!")}});var clearSelected=document.getElementById("clearSelected");clearSelected.addEventListener("click",deleteSelected);function deleteSelected(){if(mergeSwitch){if(selectedMesh&&num>0){switch(selectedMesh.geometry.name){case "cube":Bnum=Bnum-8;break;case "seven":Bnum=Bnum-4;break;case "tShape":Bnum=Bnum-4;break;case "snake":Bnum=Bnum-4;break;case "stick":Bnum=Bnum-4;break;case "cover":Bnum=Bnum-1.5;break;case "cup":Bnum=Bnum-344;break;case "headphoneStand_lower":Bnum=Bnum-58;break;case "headphoneStand_upper":Bnum=Bnum-60;break;case "penHolder":Bnum=Bnum-344;break;case "plantPot":Bnum=Bnum-166;break;case "iphoneStand":Bnum=Bnum-64;break}
num=num-1}
ini=ini-1;scene.remove(selectedMesh);selectedMesh.geometry.dispose();selectedMesh.material.dispose();selectedMesh=null;var still3dPhoto;for(var i=2;i<scene.children.length;i++){if(scene.children[i].geometry.name=="3dPhoto"){still3dPhoto="yes";break}}
if(still3dPhoto!="yes"){if(mycanvas.className=="topMenuIcon imgCanvas"){mycanvas.classList.add("sr-only");mycontext.clearRect(0,0,60,60)}}}
else{alert("Already merged! Please EXPORT or RESTART!")}}
var clearAll=document.getElementById("clearAll");clearAll.addEventListener("click",function(){location.reload()});var hiddenGeometry;window.addEventListener("keydown",function(e){switch(e.keyCode){case 39:if(selectedMesh.geometry.name=="text"){selectedMesh.translateX(5)}
else{selectedMesh.translateX(10)}
break;case 37:if(selectedMesh.geometry.name=="text"){selectedMesh.translateX(-5)}
else{selectedMesh.translateX(-10)}
break;case 38:if(selectedMesh.geometry.name=="text"){selectedMesh.translateZ(-5)}
else{selectedMesh.translateZ(-10)}
break;case 40:if(selectedMesh.geometry.name=="text"){selectedMesh.translateZ(5)}
else{selectedMesh.translateZ(10)}
break;case 65:if(selectedMesh.geometry.name=="text"){selectedMesh.translateY(5)}
else{selectedMesh.translateY(10)}
break;case 83:if(selectedMesh.geometry.name=="text"){selectedMesh.translateY(-5)}
else{selectedMesh.translateY(-10);if(selectedMesh.children[0]){selectedMesh.children[0].translateY(-10)}}
break;case 90:selectedMesh.rotateX(Math.PI/2);break;case 88:selectedMesh.rotateY(Math.PI/2);break;case 67:selectedMesh.rotateZ(Math.PI/2);break;case 189:selectedMesh.geometry.scale(0.5,0.5,0.5);break;case 187:selectedMesh.geometry.scale(2,2,2);break;case 46:deleteSelected();break;case 80:mesh[ini]=selectedMesh.clone();mesh[ini].material=new THREE.MeshStandardMaterial({color:0xffffff,side:THREE.DoubleSide});scene.add(mesh[ini]);switch(selectedMesh.geometry.name){case "cube":Bnum=Bnum+8;break;case "seven":Bnum=Bnum+4;break;case "snake":Bnum=Bnum+4;break;case "stick":Bnum=Bnum+4;break;case "tShape":Bnum=Bnum+4;break;case "cover":Bnum=Bnum+1.5;break}
selectedMesh=mesh[ini];ini=ini+1;num=num+1;break}},!1);var mergeAll=document.getElementById("merge");var mergedMesh=null;var mergedHidden=null;var mergedHiddenGeometry;mergeAll.addEventListener("click",merging);function merging(){if(scene.children.length>2&&mergeSwitch){var singleGeometry=new THREE.Geometry();for(var i=2;i<scene.children.length;i++){if(scene.children[i].geometry instanceof THREE.BufferGeometry){var geo=new THREE.Geometry().fromBufferGeometry(scene.children[i].geometry)}
else{var geo=scene.children[i].geometry}
scene.children[i].updateMatrix();singleGeometry.merge(geo,scene.children[i].matrix)}
singleGeometry.mergeVertices();singleGeometry.verticesNeedUpdate=!0;console.log("Merge succeeded");var singleGeometry2=new THREE.Geometry();if(hidden.length>0){for(var i=0;i<hidden.length;i++){if(hidden[i]){var geo=new THREE.Geometry().fromBufferGeometry(hidden[i].geometry);hidden[i].updateMatrix();singleGeometry2.merge(geo,hidden[i].matrix)}}
singleGeometry2.mergeVertices();singleGeometry2.verticesNeedUpdate=!0}
var material=new THREE.MeshStandardMaterial({color:0x83d46a,side:THREE.DoubleSide});mergedMesh=new THREE.Mesh(singleGeometry,material);mergedHiddenGeometry=singleGeometry2;scene.add(mergedMesh);if(mesh.length>0){for(var i=0;i<mesh.length;i++){if(mesh[i]){scene.remove(mesh[i])}}}
console.log("SCENE has "+scene.children.length+" objects, including two lights and the merged mesh");firstMesh=null;preMesh=null;selectedMesh=null;ini=0;mergeSwitch=null;num=1}
else if(scene.children.length<3){alert("There is nothing to merge!")}
else if(mergeSwitch==null){alert("Already merged!")}}
var exporter=new THREE.STLExporter();var link=document.createElement('a');link.style.display='none';document.body.appendChild(link);function save(blob,filename){link.href=URL.createObjectURL(blob);link.download=filename;link.click()}
function saveString(text,filename){save(new Blob([text],{type:'text/plain'}),filename)}
function saveArrayBuffer(buffer,filename){save(new Blob([buffer],{type:'application/octet-stream'}),filename)}
function exportBinary(){var result=exporter.parse(scene,{binary:!0});saveArrayBuffer(result,'LeTris.stl')}
var exporting=document.getElementById("export");exporting.addEventListener("click",function(){if(num>0&&mergeSwitch==null){exportBinary()}
else{alert("Please merge before export")}});var raycaster=new THREE.Raycaster();var mouse=new THREE.Vector3(0,0,0);var selectedMesh=null;var firstMesh=null;var touch;var preMesh=null;function onMouseMove(event){event.preventDefault();mouse.x=(event.clientX/window.innerWidth)*2-1;mouse.y=-(event.clientY/500)*2+1}
webGLRenderer.domElement.addEventListener("click",clickChoose);function clickChoose(){if(touch.length>0){if(preMesh){preMesh.material.color.setHex(0xffffff)}
selectedMesh=firstMesh;preMesh=selectedMesh}
else{selectedMesh=null}}
var num=0;var Bnum=0;render();function render(){if(status==="running"){displayLoader.className="loader-background"}
else if(status==="complete"){displayLoader.classList.add("loader-hide")}
document.getElementById("counter").innerHTML="Object: "+num;document.getElementById("blockCounter").innerHTML="Total blocks: "+Bnum;raycaster.setFromCamera(mouse,camera);var intersects=raycaster.intersectObjects(scene.children);touch=intersects;if(intersects.length>0&&mergeSwitch){firstMesh=intersects[0].object;firstMesh.material.color.set(0xff0000)}
else{if(firstMesh){firstMesh.material.color.set(0xffffff)}
if(selectedMesh){selectedMesh.material.color.set(0xff0000)}}
controls.update();webGLRenderer.clear();webGLRenderer.render(scene2,camera);webGLRenderer.clearDepth();webGLRenderer.render(scene,camera);requestAnimationFrame(render)}
